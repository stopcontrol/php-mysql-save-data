<html>
<head>
</head>
<body>
</body>
<script>

var n_conditions = 4;
var subject_id = Math.floor(Math.random()*100000);

assign_condition(subject_id, n_conditions, success, failure);

function assign_condition(subject_id, n_conditions, callback_success, callback_failure){
  var xhr = new XMLHttpRequest();
  xhr.open('POST', 'assign_subject_condition.php');
  xhr.setRequestHeader('Content-Type', 'application/json');
  xhr.onload = function() {
    if(xhr.status == 200){
      var response = JSON.parse(xhr.responseText);
      console.log(response.success);
      console.log(response.assigned_condition);
      if(response.success){
        callback_success(response);
      } else {
        callback_failure();
      }
    }
  };
  xhr.onerror = function() {
    callback_failure();
  }
  xhr.send(JSON.stringify({n_conditions: n_conditions, id: subject_id}));
}

function success(response){
  var condition = response.assigned_condition;
}

function failure(){
  console.log("Something has gone wrong. There was a technical problem loading the experiment. Apologies for the incovenience.");
}

</script>
</html>
